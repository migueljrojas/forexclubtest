{"version":3,"sources":["src/_scripts/node_modules/browser-pack/_prelude.js","src/_scripts/src/_scripts/form-validation.js","src/_scripts/src/_scripts/main.js","src/_scripts/src/_scripts/table-generator.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","'use strict';\r\n\r\nvar FormValidation = function() {\r\n    var formSubmitButton = document.querySelector('button[type=submit]');\r\n    var form = document.querySelector('.libertex-form');\r\n    var formInputs = document.querySelectorAll('.libertex-form__input');\r\n    var nameInput = document.getElementById('name');\r\n    var surnameInput = document.getElementById('surname');\r\n    var phoneInput = document.getElementById('phone');\r\n    var emailInput = document.getElementById('email');\r\n\r\n    form.addEventListener('blur', validateFormSubmission, true);\r\n\r\n    function validateFormSubmission() {\r\n        if ( !isRequiredInputEmpty() ) {\r\n            enableFormSubmitButton();\r\n        } else {\r\n            disableFormSubmitButton();\r\n        }\r\n    }\r\n\r\n    function isRequiredInputEmpty() {\r\n        var requiredInputs = document.querySelectorAll('input[required]');\r\n        var requiredInputsArray = [].slice.call(requiredInputs);\r\n        var filledInputs = 0;\r\n\r\n        requiredInputsArray.forEach(function(input) {\r\n            var inputValue = input.value;\r\n\r\n            if (inputValue !== '') {\r\n                filledInputs++;\r\n            }\r\n        });\r\n\r\n        return requiredInputsArray.length === filledInputs ? false : true;\r\n    }\r\n\r\n    function enableFormSubmitButton() {\r\n        formSubmitButton.disabled = false;\r\n    }\r\n\r\n    function disableFormSubmitButton() {\r\n        formSubmitButton.disabled = true;\r\n    }\r\n\r\n    formSubmitButton.addEventListener('click', submitForm, true);\r\n\r\n    function submitForm(event) {\r\n        event.preventDefault();\r\n        disableFormSubmitButton();\r\n\r\n        var inputValuesAreValid = validateInputValues();\r\n\r\n        if (inputValuesAreValid) {\r\n            displaySuccessfulMessage();\r\n            disableFormSubmitButton();\r\n        } else {\r\n            catchFormValidationError();\r\n            enableFormSubmitButton();\r\n        }\r\n    }\r\n\r\n    function validateInputValues() {\r\n        var isInputValuesValid = false;\r\n\r\n        if (\r\n            valueDontContainNumbers(nameInput.value) &&\r\n            valueDontContainNumbers(surnameInput.value) &&\r\n            valueIsValidPhone(phoneInput.value) &&\r\n            valueIsValidEmail(emailInput.value)\r\n        ) {\r\n            isInputValuesValid = true;\r\n        }\r\n\r\n        return isInputValuesValid;\r\n    }\r\n\r\n    function valueDontContainNumbers(value) {\r\n        var regexCondition = /^[a-z]+$/i;\r\n        return regexCondition.test(value);\r\n    }\r\n\r\n    function valueIsValidPhone(value) {\r\n        var regexCondition = /^[+]*[(]{0,1}[0-9 ]{1,4}[)]{0,1}[(]{0,1}[0-9]{1,3}[)]{0,1}[-\\s\\.0-9]*$/g;\r\n        return regexCondition.test(value);\r\n    }\r\n\r\n    function valueIsValidEmail(value) {\r\n        var regexCondition = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{1,}))$/g;\r\n\r\n        if (value !== '') {\r\n            return regexCondition.test(value);\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    function displaySuccessfulMessage() {\r\n        setTimeout(function() {\r\n            form.classList.add('libertex-form--success');\r\n            resetForm();\r\n\r\n            setTimeout(function() {\r\n                form.classList.remove('libertex-form--success');\r\n            }, 4000);\r\n        }, 2000);\r\n    }\r\n\r\n    function catchFormValidationError() {\r\n\r\n        switch (false) {\r\n            case valueDontContainNumbers(nameInput.value):\r\n                displayErrorMessage(nameInput, 'This field should be only letters');\r\n                break;\r\n            case valueDontContainNumbers(surnameInput.value):\r\n                displayErrorMessage(surnameInput, 'This field should be only letters');\r\n                break;\r\n            case valueIsValidPhone(phoneInput.value):\r\n                displayErrorMessage(phoneInput, 'Please enter a valid phone number');\r\n                break;\r\n            case valueIsValidEmail(emailInput.value):\r\n                displayErrorMessage(emailInput, 'Please enter a valid email address');\r\n                break;\r\n        }\r\n    }\r\n\r\n    function displayErrorMessage(input, message) {\r\n        input.classList.add('libertex-form__input--error');\r\n        var errorMessageContainer = input.nextSibling;\r\n\r\n        errorMessageContainer.innerHTML = message;\r\n    }\r\n\r\n    form.addEventListener('focus', hideErrorMessages, true);\r\n\r\n    function hideErrorMessages() {\r\n        var errorMessage = document.querySelector('.libertex-form__input--error');\r\n\r\n        if (errorMessage) {\r\n            errorMessage.classList.remove('libertex-form__input--error');\r\n        }\r\n    }\r\n\r\n    function resetForm() {\r\n        var formInputsArray = [].slice.call(formInputs);\r\n\r\n        formInputsArray.forEach(function(input) {\r\n            input.value = '';\r\n        });\r\n    }\r\n\r\n}\r\n\r\nmodule.exports = FormValidation;\r\n","'use strict';\r\n\r\nvar FormValidation = require('./form-validation');\r\nvar TableGenerator = require('./table-generator');\r\n\r\n(function() {\r\n    new FormValidation();\r\n    new TableGenerator();\r\n})();\r\n","'use strict';\r\n\r\nvar TableGenerator = function() {\r\n    var tableData = [\r\n        {\r\n            money: 5321,\r\n            account: \"123 456 000\",\r\n            country: \"rusia\"\r\n        },\r\n        {\r\n            money: 3000,\r\n            account: \"425 238 238\",\r\n            country: \"spain\"\r\n        },\r\n        {\r\n            money: 890,\r\n            account: \"123 543 548\",\r\n            country: \"china\"\r\n        },\r\n        {\r\n            money: 777,\r\n            account: \"090 235 453\",\r\n            country: \"rusia\"\r\n        },\r\n        {\r\n            money: 666,\r\n            account: \"009 281 443\",\r\n            country: \"spain\"\r\n        },\r\n        {\r\n            money: 555,\r\n            account: \"515 654 522\",\r\n            country: \"china\"\r\n        },\r\n        {\r\n            money: 444,\r\n            account: \"765 452 241\",\r\n            country: \"rusia\"\r\n        },\r\n        {\r\n            money: 333,\r\n            account: \"562 183 816\",\r\n            country: \"spain\"\r\n        },\r\n        {\r\n            money: 222,\r\n            account: \"642 452 555\",\r\n            country: \"china\"\r\n        },\r\n        {\r\n            money: 111,\r\n            account: \"212 552 112\",\r\n            country: \"rusia\"\r\n        }\r\n    ];\r\n    var table = document.querySelector('.libertex-ranking__table');\r\n    var tableBody = document.querySelector('.libertex-ranking__table-body');\r\n    var tableRows = tableBody.querySelectorAll('.libertex-ranking__table-row');\r\n\r\n    populateTableWithData();\r\n\r\n    function populateTableWithData() {\r\n        var tableSortCriteriaInLocalStorage = isTableSorCriteriaInLocalStorage();\r\n\r\n        if (tableSortCriteriaInLocalStorage) {\r\n            var orderedTableData =\r\n                tableData.concat().sort(compareValues(tableSortCriteriaInLocalStorage));\r\n            getCellsData(orderedTableData);\r\n        } else {\r\n            getCellsData(tableData);\r\n        }\r\n\r\n        setActiveSort(tableSortCriteriaInLocalStorage);\r\n    }\r\n\r\n    function isTableSorCriteriaInLocalStorage() {\r\n        return JSON.parse(localStorage.getItem('libertex-table-sort-criteria'));\r\n    }\r\n\r\n    function getCellsData(data) {\r\n\r\n        data.forEach(function(row, index) {\r\n            var rowCells = tableRows[index].querySelectorAll('.libertex-ranking__table-cell');\r\n\r\n            rowCells[0].innerHTML = '<span>' + row.money + '</span>';\r\n            rowCells[1].innerHTML = '<span>' + row.account + '</span>';\r\n            rowCells[2].innerHTML = '<img src=\"images/' + row.country + '.png\" alt=\"'+ row.country +'\" />';\r\n        });\r\n    }\r\n\r\n    table.addEventListener('click', sortTableData, false);\r\n\r\n    function sortTableData(event) {\r\n\r\n        var targetParent = event.target.parentNode;\r\n\r\n        if (targetParent.hasAttribute('data-sort')) {\r\n            var sortCriteria = targetParent.getAttribute('data-sort');\r\n            var orderedTableData =\r\n                tableData.concat().sort(compareValues(sortCriteria));\r\n\r\n            getCellsData(orderedTableData);\r\n            setActiveSort(sortCriteria);\r\n            saveTableSortCriteria(sortCriteria);\r\n        }\r\n    }\r\n\r\n    function setActiveSort(sortCriteria) {\r\n        var tableRows = tableBody.querySelectorAll('.libertex-ranking__table-row');\r\n        var sortedCells = document.querySelectorAll('.libertex-ranking__table-cell--sorted');\r\n        var sortedCellsArray = [].slice.call(sortedCells);\r\n        var tableHeader = document.querySelector('.libertex-ranking__table-header');\r\n        var tableHeaderCells = tableHeader.querySelectorAll('.libertex-ranking__table-cell--header');\r\n        var cellIndex = 0;\r\n\r\n\r\n        if (sortCriteria === 'account') {\r\n            cellIndex = 1;\r\n        }\r\n\r\n        if (sortCriteria === 'country') {\r\n            cellIndex = 2;\r\n        }\r\n\r\n        sortedCellsArray.forEach(function(cell) {\r\n            cell.classList.remove('libertex-ranking__table-cell--sorted');\r\n        });\r\n\r\n        for (var rowIndex = 0; rowIndex <= 2; rowIndex++) {\r\n            var cells = tableRows[rowIndex].querySelectorAll('.libertex-ranking__table-cell');\r\n\r\n            cells[cellIndex].classList.add('libertex-ranking__table-cell--sorted');\r\n        }\r\n\r\n        tableHeaderCells[cellIndex].classList.add('libertex-ranking__table-cell--sorted');\r\n    }\r\n\r\n    function compareValues(key) {\r\n        return function(a, b) {\r\n\r\n            var comparison = 0;\r\n            if (a[key] > b[key]) {\r\n                comparison = 1;\r\n            } else if (a[key] < b[key]) {\r\n                comparison = -1;\r\n            }\r\n\r\n            return comparison * -1;\r\n        };\r\n    }\r\n\r\n    function saveTableSortCriteria(sortCriteria) {\r\n        localStorage.setItem('libertex-table-sort-criteria', JSON.stringify(sortCriteria));\r\n    }\r\n}\r\n\r\nmodule.exports = TableGenerator;\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvX3NjcmlwdHMvZm9ybS12YWxpZGF0aW9uLmpzIiwic3JjL19zY3JpcHRzL21haW4uanMiLCJzcmMvX3NjcmlwdHMvdGFibGUtZ2VuZXJhdG9yLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbnZhciBGb3JtVmFsaWRhdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGZvcm1TdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1zdWJtaXRdJyk7XHJcbiAgICB2YXIgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saWJlcnRleC1mb3JtJyk7XHJcbiAgICB2YXIgZm9ybUlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saWJlcnRleC1mb3JtX19pbnB1dCcpO1xyXG4gICAgdmFyIG5hbWVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJyk7XHJcbiAgICB2YXIgc3VybmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1cm5hbWUnKTtcclxuICAgIHZhciBwaG9uZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Bob25lJyk7XHJcbiAgICB2YXIgZW1haWxJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbWFpbCcpO1xyXG5cclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHZhbGlkYXRlRm9ybVN1Ym1pc3Npb24sIHRydWUpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHZhbGlkYXRlRm9ybVN1Ym1pc3Npb24oKSB7XHJcbiAgICAgICAgaWYgKCAhaXNSZXF1aXJlZElucHV0RW1wdHkoKSApIHtcclxuICAgICAgICAgICAgZW5hYmxlRm9ybVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRpc2FibGVGb3JtU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzUmVxdWlyZWRJbnB1dEVtcHR5KCkge1xyXG4gICAgICAgIHZhciByZXF1aXJlZElucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3JlcXVpcmVkXScpO1xyXG4gICAgICAgIHZhciByZXF1aXJlZElucHV0c0FycmF5ID0gW10uc2xpY2UuY2FsbChyZXF1aXJlZElucHV0cyk7XHJcbiAgICAgICAgdmFyIGZpbGxlZElucHV0cyA9IDA7XHJcblxyXG4gICAgICAgIHJlcXVpcmVkSW5wdXRzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbnB1dCkge1xyXG4gICAgICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGlucHV0LnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlucHV0VmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICBmaWxsZWRJbnB1dHMrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVxdWlyZWRJbnB1dHNBcnJheS5sZW5ndGggPT09IGZpbGxlZElucHV0cyA/IGZhbHNlIDogdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBlbmFibGVGb3JtU3VibWl0QnV0dG9uKCkge1xyXG4gICAgICAgIGZvcm1TdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkaXNhYmxlRm9ybVN1Ym1pdEJ1dHRvbigpIHtcclxuICAgICAgICBmb3JtU3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBmb3JtU3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3VibWl0Rm9ybSwgdHJ1ZSk7XHJcblxyXG4gICAgZnVuY3Rpb24gc3VibWl0Rm9ybShldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZGlzYWJsZUZvcm1TdWJtaXRCdXR0b24oKTtcclxuXHJcbiAgICAgICAgdmFyIGlucHV0VmFsdWVzQXJlVmFsaWQgPSB2YWxpZGF0ZUlucHV0VmFsdWVzKCk7XHJcblxyXG4gICAgICAgIGlmIChpbnB1dFZhbHVlc0FyZVZhbGlkKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlTdWNjZXNzZnVsTWVzc2FnZSgpO1xyXG4gICAgICAgICAgICBkaXNhYmxlRm9ybVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhdGNoRm9ybVZhbGlkYXRpb25FcnJvcigpO1xyXG4gICAgICAgICAgICBlbmFibGVGb3JtU3VibWl0QnV0dG9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHZhbGlkYXRlSW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgdmFyIGlzSW5wdXRWYWx1ZXNWYWxpZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHZhbHVlRG9udENvbnRhaW5OdW1iZXJzKG5hbWVJbnB1dC52YWx1ZSkgJiZcclxuICAgICAgICAgICAgdmFsdWVEb250Q29udGFpbk51bWJlcnMoc3VybmFtZUlucHV0LnZhbHVlKSAmJlxyXG4gICAgICAgICAgICB2YWx1ZUlzVmFsaWRQaG9uZShwaG9uZUlucHV0LnZhbHVlKSAmJlxyXG4gICAgICAgICAgICB2YWx1ZUlzVmFsaWRFbWFpbChlbWFpbElucHV0LnZhbHVlKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBpc0lucHV0VmFsdWVzVmFsaWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGlzSW5wdXRWYWx1ZXNWYWxpZDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB2YWx1ZURvbnRDb250YWluTnVtYmVycyh2YWx1ZSkge1xyXG4gICAgICAgIHZhciByZWdleENvbmRpdGlvbiA9IC9eW2Etel0rJC9pO1xyXG4gICAgICAgIHJldHVybiByZWdleENvbmRpdGlvbi50ZXN0KHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB2YWx1ZUlzVmFsaWRQaG9uZSh2YWx1ZSkge1xyXG4gICAgICAgIHZhciByZWdleENvbmRpdGlvbiA9IC9eWytdKlsoXXswLDF9WzAtOSBdezEsNH1bKV17MCwxfVsoXXswLDF9WzAtOV17MSwzfVspXXswLDF9Wy1cXHNcXC4wLTldKiQvZztcclxuICAgICAgICByZXR1cm4gcmVnZXhDb25kaXRpb24udGVzdCh2YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdmFsdWVJc1ZhbGlkRW1haWwodmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVnZXhDb25kaXRpb24gPSAvXigoW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31dKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17MSx9KSkkL2c7XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZ2V4Q29uZGl0aW9uLnRlc3QodmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkaXNwbGF5U3VjY2Vzc2Z1bE1lc3NhZ2UoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZm9ybS5jbGFzc0xpc3QuYWRkKCdsaWJlcnRleC1mb3JtLS1zdWNjZXNzJyk7XHJcbiAgICAgICAgICAgIHJlc2V0Rm9ybSgpO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnbGliZXJ0ZXgtZm9ybS0tc3VjY2VzcycpO1xyXG4gICAgICAgICAgICB9LCA0MDAwKTtcclxuICAgICAgICB9LCAyMDAwKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjYXRjaEZvcm1WYWxpZGF0aW9uRXJyb3IoKSB7XHJcblxyXG4gICAgICAgIHN3aXRjaCAoZmFsc2UpIHtcclxuICAgICAgICAgICAgY2FzZSB2YWx1ZURvbnRDb250YWluTnVtYmVycyhuYW1lSW5wdXQudmFsdWUpOlxyXG4gICAgICAgICAgICAgICAgZGlzcGxheUVycm9yTWVzc2FnZShuYW1lSW5wdXQsICdUaGlzIGZpZWxkIHNob3VsZCBiZSBvbmx5IGxldHRlcnMnKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIHZhbHVlRG9udENvbnRhaW5OdW1iZXJzKHN1cm5hbWVJbnB1dC52YWx1ZSk6XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKHN1cm5hbWVJbnB1dCwgJ1RoaXMgZmllbGQgc2hvdWxkIGJlIG9ubHkgbGV0dGVycycpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgdmFsdWVJc1ZhbGlkUGhvbmUocGhvbmVJbnB1dC52YWx1ZSk6XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5RXJyb3JNZXNzYWdlKHBob25lSW5wdXQsICdQbGVhc2UgZW50ZXIgYSB2YWxpZCBwaG9uZSBudW1iZXInKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIHZhbHVlSXNWYWxpZEVtYWlsKGVtYWlsSW5wdXQudmFsdWUpOlxyXG4gICAgICAgICAgICAgICAgZGlzcGxheUVycm9yTWVzc2FnZShlbWFpbElucHV0LCAnUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcycpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRpc3BsYXlFcnJvck1lc3NhZ2UoaW5wdXQsIG1lc3NhZ2UpIHtcclxuICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdsaWJlcnRleC1mb3JtX19pbnB1dC0tZXJyb3InKTtcclxuICAgICAgICB2YXIgZXJyb3JNZXNzYWdlQ29udGFpbmVyID0gaW5wdXQubmV4dFNpYmxpbmc7XHJcblxyXG4gICAgICAgIGVycm9yTWVzc2FnZUNvbnRhaW5lci5pbm5lckhUTUwgPSBtZXNzYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBoaWRlRXJyb3JNZXNzYWdlcywgdHJ1ZSk7XHJcblxyXG4gICAgZnVuY3Rpb24gaGlkZUVycm9yTWVzc2FnZXMoKSB7XHJcbiAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saWJlcnRleC1mb3JtX19pbnB1dC0tZXJyb3InKTtcclxuXHJcbiAgICAgICAgaWYgKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnbGliZXJ0ZXgtZm9ybV9faW5wdXQtLWVycm9yJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlc2V0Rm9ybSgpIHtcclxuICAgICAgICB2YXIgZm9ybUlucHV0c0FycmF5ID0gW10uc2xpY2UuY2FsbChmb3JtSW5wdXRzKTtcclxuXHJcbiAgICAgICAgZm9ybUlucHV0c0FycmF5LmZvckVhY2goZnVuY3Rpb24oaW5wdXQpIHtcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRm9ybVZhbGlkYXRpb247XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbnZhciBGb3JtVmFsaWRhdGlvbiA9IHJlcXVpcmUoJy4vZm9ybS12YWxpZGF0aW9uJyk7XHJcbnZhciBUYWJsZUdlbmVyYXRvciA9IHJlcXVpcmUoJy4vdGFibGUtZ2VuZXJhdG9yJyk7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBuZXcgRm9ybVZhbGlkYXRpb24oKTtcclxuICAgIG5ldyBUYWJsZUdlbmVyYXRvcigpO1xyXG59KSgpO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG52YXIgVGFibGVHZW5lcmF0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciB0YWJsZURhdGEgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBtb25leTogNTMyMSxcclxuICAgICAgICAgICAgYWNjb3VudDogXCIxMjMgNDU2IDAwMFwiLFxyXG4gICAgICAgICAgICBjb3VudHJ5OiBcInJ1c2lhXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbW9uZXk6IDMwMDAsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiNDI1IDIzOCAyMzhcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJzcGFpblwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiA4OTAsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiMTIzIDU0MyA1NDhcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJjaGluYVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiA3NzcsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiMDkwIDIzNSA0NTNcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJydXNpYVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiA2NjYsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiMDA5IDI4MSA0NDNcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJzcGFpblwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiA1NTUsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiNTE1IDY1NCA1MjJcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJjaGluYVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiA0NDQsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiNzY1IDQ1MiAyNDFcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJydXNpYVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiAzMzMsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiNTYyIDE4MyA4MTZcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJzcGFpblwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiAyMjIsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiNjQyIDQ1MiA1NTVcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJjaGluYVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vbmV5OiAxMTEsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IFwiMjEyIDU1MiAxMTJcIixcclxuICAgICAgICAgICAgY291bnRyeTogXCJydXNpYVwiXHJcbiAgICAgICAgfVxyXG4gICAgXTtcclxuICAgIHZhciB0YWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saWJlcnRleC1yYW5raW5nX190YWJsZScpO1xyXG4gICAgdmFyIHRhYmxlQm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saWJlcnRleC1yYW5raW5nX190YWJsZS1ib2R5Jyk7XHJcbiAgICB2YXIgdGFibGVSb3dzID0gdGFibGVCb2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJy5saWJlcnRleC1yYW5raW5nX190YWJsZS1yb3cnKTtcclxuXHJcbiAgICBwb3B1bGF0ZVRhYmxlV2l0aERhdGEoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBwb3B1bGF0ZVRhYmxlV2l0aERhdGEoKSB7XHJcbiAgICAgICAgdmFyIHRhYmxlU29ydENyaXRlcmlhSW5Mb2NhbFN0b3JhZ2UgPSBpc1RhYmxlU29yQ3JpdGVyaWFJbkxvY2FsU3RvcmFnZSgpO1xyXG5cclxuICAgICAgICBpZiAodGFibGVTb3J0Q3JpdGVyaWFJbkxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJlZFRhYmxlRGF0YSA9XHJcbiAgICAgICAgICAgICAgICB0YWJsZURhdGEuY29uY2F0KCkuc29ydChjb21wYXJlVmFsdWVzKHRhYmxlU29ydENyaXRlcmlhSW5Mb2NhbFN0b3JhZ2UpKTtcclxuICAgICAgICAgICAgZ2V0Q2VsbHNEYXRhKG9yZGVyZWRUYWJsZURhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGdldENlbGxzRGF0YSh0YWJsZURhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0QWN0aXZlU29ydCh0YWJsZVNvcnRDcml0ZXJpYUluTG9jYWxTdG9yYWdlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpc1RhYmxlU29yQ3JpdGVyaWFJbkxvY2FsU3RvcmFnZSgpIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGliZXJ0ZXgtdGFibGUtc29ydC1jcml0ZXJpYScpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRDZWxsc0RhdGEoZGF0YSkge1xyXG5cclxuICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24ocm93LCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgcm93Q2VsbHMgPSB0YWJsZVJvd3NbaW5kZXhdLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saWJlcnRleC1yYW5raW5nX190YWJsZS1jZWxsJyk7XHJcblxyXG4gICAgICAgICAgICByb3dDZWxsc1swXS5pbm5lckhUTUwgPSAnPHNwYW4+JyArIHJvdy5tb25leSArICc8L3NwYW4+JztcclxuICAgICAgICAgICAgcm93Q2VsbHNbMV0uaW5uZXJIVE1MID0gJzxzcGFuPicgKyByb3cuYWNjb3VudCArICc8L3NwYW4+JztcclxuICAgICAgICAgICAgcm93Q2VsbHNbMl0uaW5uZXJIVE1MID0gJzxpbWcgc3JjPVwiaW1hZ2VzLycgKyByb3cuY291bnRyeSArICcucG5nXCIgYWx0PVwiJysgcm93LmNvdW50cnkgKydcIiAvPic7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGFibGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzb3J0VGFibGVEYXRhLCBmYWxzZSk7XHJcblxyXG4gICAgZnVuY3Rpb24gc29ydFRhYmxlRGF0YShldmVudCkge1xyXG5cclxuICAgICAgICB2YXIgdGFyZ2V0UGFyZW50ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGU7XHJcblxyXG4gICAgICAgIGlmICh0YXJnZXRQYXJlbnQuaGFzQXR0cmlidXRlKCdkYXRhLXNvcnQnKSkge1xyXG4gICAgICAgICAgICB2YXIgc29ydENyaXRlcmlhID0gdGFyZ2V0UGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1zb3J0Jyk7XHJcbiAgICAgICAgICAgIHZhciBvcmRlcmVkVGFibGVEYXRhID1cclxuICAgICAgICAgICAgICAgIHRhYmxlRGF0YS5jb25jYXQoKS5zb3J0KGNvbXBhcmVWYWx1ZXMoc29ydENyaXRlcmlhKSk7XHJcblxyXG4gICAgICAgICAgICBnZXRDZWxsc0RhdGEob3JkZXJlZFRhYmxlRGF0YSk7XHJcbiAgICAgICAgICAgIHNldEFjdGl2ZVNvcnQoc29ydENyaXRlcmlhKTtcclxuICAgICAgICAgICAgc2F2ZVRhYmxlU29ydENyaXRlcmlhKHNvcnRDcml0ZXJpYSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldEFjdGl2ZVNvcnQoc29ydENyaXRlcmlhKSB7XHJcbiAgICAgICAgdmFyIHRhYmxlUm93cyA9IHRhYmxlQm9keS5xdWVyeVNlbGVjdG9yQWxsKCcubGliZXJ0ZXgtcmFua2luZ19fdGFibGUtcm93Jyk7XHJcbiAgICAgICAgdmFyIHNvcnRlZENlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxpYmVydGV4LXJhbmtpbmdfX3RhYmxlLWNlbGwtLXNvcnRlZCcpO1xyXG4gICAgICAgIHZhciBzb3J0ZWRDZWxsc0FycmF5ID0gW10uc2xpY2UuY2FsbChzb3J0ZWRDZWxscyk7XHJcbiAgICAgICAgdmFyIHRhYmxlSGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpYmVydGV4LXJhbmtpbmdfX3RhYmxlLWhlYWRlcicpO1xyXG4gICAgICAgIHZhciB0YWJsZUhlYWRlckNlbGxzID0gdGFibGVIZWFkZXIucXVlcnlTZWxlY3RvckFsbCgnLmxpYmVydGV4LXJhbmtpbmdfX3RhYmxlLWNlbGwtLWhlYWRlcicpO1xyXG4gICAgICAgIHZhciBjZWxsSW5kZXggPSAwO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKHNvcnRDcml0ZXJpYSA9PT0gJ2FjY291bnQnKSB7XHJcbiAgICAgICAgICAgIGNlbGxJbmRleCA9IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc29ydENyaXRlcmlhID09PSAnY291bnRyeScpIHtcclxuICAgICAgICAgICAgY2VsbEluZGV4ID0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNvcnRlZENlbGxzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihjZWxsKSB7XHJcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnbGliZXJ0ZXgtcmFua2luZ19fdGFibGUtY2VsbC0tc29ydGVkJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZvciAodmFyIHJvd0luZGV4ID0gMDsgcm93SW5kZXggPD0gMjsgcm93SW5kZXgrKykge1xyXG4gICAgICAgICAgICB2YXIgY2VsbHMgPSB0YWJsZVJvd3Nbcm93SW5kZXhdLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saWJlcnRleC1yYW5raW5nX190YWJsZS1jZWxsJyk7XHJcblxyXG4gICAgICAgICAgICBjZWxsc1tjZWxsSW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2xpYmVydGV4LXJhbmtpbmdfX3RhYmxlLWNlbGwtLXNvcnRlZCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGFibGVIZWFkZXJDZWxsc1tjZWxsSW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2xpYmVydGV4LXJhbmtpbmdfX3RhYmxlLWNlbGwtLXNvcnRlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNvbXBhcmVWYWx1ZXMoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGEsIGIpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBjb21wYXJpc29uID0gMDtcclxuICAgICAgICAgICAgaWYgKGFba2V5XSA+IGJba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IDE7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYVtrZXldIDwgYltrZXldKSB7XHJcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uID0gLTE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uICogLTE7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzYXZlVGFibGVTb3J0Q3JpdGVyaWEoc29ydENyaXRlcmlhKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xpYmVydGV4LXRhYmxlLXNvcnQtY3JpdGVyaWEnLCBKU09OLnN0cmluZ2lmeShzb3J0Q3JpdGVyaWEpKTtcclxuICAgIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBUYWJsZUdlbmVyYXRvcjtcclxuIl19"}